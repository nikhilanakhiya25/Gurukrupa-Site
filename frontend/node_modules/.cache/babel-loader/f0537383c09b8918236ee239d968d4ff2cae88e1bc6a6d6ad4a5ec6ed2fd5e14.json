{"ast":null,"code":"import _objectSpread from\"C:/Users/anakhiya nikhil/OneDrive/Desktop/mern-ecommerce-full/Gurukrupa-Site/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>useContext(AuthContext);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(null);const[loading,setLoading]=useState(true);// ðŸ”¹ Load auth from localStorage\nuseEffect(()=>{try{const savedUser=localStorage.getItem(\"user\");const savedToken=localStorage.getItem(\"token\");if(savedUser&&savedToken){setUser(JSON.parse(savedUser));setToken(savedToken);}}catch(err){console.error(\"Auth load error:\",err);localStorage.clear();}finally{setLoading(false);}},[]);// ðŸ” LOGIN (ONLY FOR AUTH)\nconst login=(userData,tokenData)=>{var _userData$role;if(!userData||!tokenData)return;const normalizedUser=_objectSpread(_objectSpread({},userData),{},{role:((_userData$role=userData.role)===null||_userData$role===void 0?void 0:_userData$role.toLowerCase())||\"user\"});setUser(normalizedUser);setToken(tokenData);localStorage.setItem(\"user\",JSON.stringify(normalizedUser));localStorage.setItem(\"token\",tokenData);};// ðŸšª LOGOUT\nconst logout=()=>{setUser(null);setToken(null);localStorage.clear();};// ðŸ›  SAFE PROFILE UPDATE (username, avatar, etc.)\nconst updateUser=updates=>{setUser(prev=>{if(!prev)return prev;const updatedUser=_objectSpread(_objectSpread({},prev),updates);localStorage.setItem(\"user\",JSON.stringify(updatedUser));return updatedUser;});};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,token,loading,login,logout,setUser:updateUser// âœ… SAFE setter\n},children:!loading&&children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","AuthContext","useAuth","AuthProvider","_ref","children","user","setUser","token","setToken","loading","setLoading","savedUser","localStorage","getItem","savedToken","JSON","parse","err","console","error","clear","login","userData","tokenData","_userData$role","normalizedUser","_objectSpread","role","toLowerCase","setItem","stringify","logout","updateUser","updates","prev","updatedUser","Provider","value"],"sources":["C:/Users/anakhiya nikhil/OneDrive/Desktop/mern-ecommerce-full/Gurukrupa-Site/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useEffect\r\n} from \"react\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\nexport const AuthProvider = ({\r\n  children\r\n}) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // ðŸ”¹ Load auth from localStorage\r\n  useEffect(() => {\r\n    try {\r\n      const savedUser = localStorage.getItem(\"user\");\r\n      const savedToken = localStorage.getItem(\"token\");\r\n\r\n      if (savedUser && savedToken) {\r\n        setUser(JSON.parse(savedUser));\r\n        setToken(savedToken);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Auth load error:\", err);\r\n      localStorage.clear();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // ðŸ” LOGIN (ONLY FOR AUTH)\r\n  const login = (userData, tokenData) => {\r\n    if (!userData || !tokenData) return;\r\n\r\n    const normalizedUser = {\r\n      ...userData,\r\n      role: userData.role?.toLowerCase() || \"user\",\r\n    };\r\n\r\n    setUser(normalizedUser);\r\n    setToken(tokenData);\r\n\r\n    localStorage.setItem(\"user\", JSON.stringify(normalizedUser));\r\n    localStorage.setItem(\"token\", tokenData);\r\n  };\r\n\r\n  // ðŸšª LOGOUT\r\n  const logout = () => {\r\n    setUser(null);\r\n    setToken(null);\r\n    localStorage.clear();\r\n  };\r\n\r\n  // ðŸ›  SAFE PROFILE UPDATE (username, avatar, etc.)\r\n  const updateUser = (updates) => {\r\n    setUser((prev) => {\r\n      if (!prev) return prev;\r\n      const updatedUser = {\r\n        ...prev,\r\n        ...updates\r\n      };\r\n      localStorage.setItem(\"user\", JSON.stringify(updatedUser));\r\n      return updatedUser;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{\r\n      user,\r\n      token,\r\n      loading,\r\n      login,\r\n      logout,\r\n      setUser: updateUser, // âœ… SAFE setter\r\n    }}>\r\n    {!loading && children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}