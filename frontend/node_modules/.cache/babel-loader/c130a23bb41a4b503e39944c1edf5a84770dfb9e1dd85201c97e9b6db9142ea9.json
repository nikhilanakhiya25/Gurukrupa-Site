{"ast":null,"code":"// frontend/src/components/Orders/UserOrders.jsx\nimport React,{useEffect,useState}from\"react\";import API from\"../api/api\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function UserOrders(){const[orders,setOrders]=useState([]);useEffect(()=>{load();},[]);const load=async()=>{try{const res=await API.get(\"/api/orders/my\",{headers:{Authorization:\"Bearer \"+localStorage.getItem(\"token\")}});setOrders(res.data);}catch(e){console.error(e);alert(\"Failed to load your orders\");}};const downloadInvoice=async orderId=>{try{const res=await fetch(\"/api/orders/\".concat(orderId,\"/invoice\"),{headers:{Authorization:\"Bearer \"+localStorage.getItem(\"token\")}});if(!res.ok)throw new Error(\"Invoice failed\");const blob=await res.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=url;a.download=\"invoice-\".concat(orderId,\".pdf\");document.body.appendChild(a);a.click();a.remove();}catch(err){console.error(err);alert(\"Invoice download failed\");}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your Orders\"}),orders.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No orders yet\"}):/*#__PURE__*/_jsx(\"div\",{children:orders.map(o=>/*#__PURE__*/_jsxs(\"div\",{style:{border:\"1px solid #ddd\",padding:10,margin:8},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order:\"}),\" \",o._id]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",o.status]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Total:\"}),\" \\u20B9\",o.totalAmount]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Items:\"}),/*#__PURE__*/_jsx(\"ul\",{children:o.items.map(it=>/*#__PURE__*/_jsxs(\"li\",{children:[it.name,\" x \",it.qty]},it.product))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>downloadInvoice(o._id),children:\"Download Invoice\"})]},o._id))})]});}","map":{"version":3,"names":["React","useEffect","useState","API","jsx","_jsx","jsxs","_jsxs","UserOrders","orders","setOrders","load","res","get","headers","Authorization","localStorage","getItem","data","e","console","error","alert","downloadInvoice","orderId","fetch","concat","ok","Error","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","remove","err","children","length","map","o","style","border","padding","margin","_id","status","totalAmount","items","it","name","qty","product","onClick"],"sources":["C:/Users/anakhiya nikhil/OneDrive/Desktop/mern-ecommerce-full/Gurukrupa-Site/frontend/src/components/userOrders.jsx"],"sourcesContent":["// frontend/src/components/Orders/UserOrders.jsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport API from \"../api/api\";\r\n\r\nexport default function UserOrders() {\r\n  const [orders, setOrders] = useState([]);\r\n\r\n  useEffect(()=> { load(); }, []);\r\n  const load = async () => {\r\n    try {\r\n      const res = await API.get(\"/api/orders/my\", { headers: { Authorization: \"Bearer \" + localStorage.getItem(\"token\") }});\r\n      setOrders(res.data);\r\n    } catch (e) {\r\n      console.error(e);\r\n      alert(\"Failed to load your orders\");\r\n    }\r\n  };\r\n\r\n  const downloadInvoice = async (orderId) => {\r\n    try {\r\n      const res = await fetch(`/api/orders/${orderId}/invoice`, { headers: { Authorization: \"Bearer \" + localStorage.getItem(\"token\") }});\r\n      if (!res.ok) throw new Error(\"Invoice failed\");\r\n      const blob = await res.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement(\"a\");\r\n      a.href = url; a.download = `invoice-${orderId}.pdf`; document.body.appendChild(a); a.click(); a.remove();\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Invoice download failed\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>Your Orders</h2>\r\n      {orders.length === 0 ? <p>No orders yet</p> : (\r\n        <div>\r\n          {orders.map(o => (\r\n            <div key={o._id} style={{border:\"1px solid #ddd\", padding:10, margin:8}}>\r\n              <div><strong>Order:</strong> {o._id}</div>\r\n              <div><strong>Status:</strong> {o.status}</div>\r\n              <div><strong>Total:</strong> â‚¹{o.totalAmount}</div>\r\n              <div><strong>Items:</strong>\r\n                <ul>{o.items.map(it => <li key={it.product}>{it.name} x {it.qty}</li>)}</ul>\r\n              </div>\r\n              <button onClick={()=> downloadInvoice(o._id)}>Download Invoice</button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}