{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\anakhiya nikhil\\\\OneDrive\\\\Desktop\\\\mern-ecommerce-full\\\\Gurukrupa-Site\\\\frontend\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  return useContext(AuthContext);\n};\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // ðŸ”¹ Load auth from localStorage\n  useEffect(() => {\n    try {\n      const savedUser = localStorage.getItem(\"user\");\n      const savedToken = localStorage.getItem(\"token\");\n      if (savedUser && savedToken) {\n        setUser(JSON.parse(savedUser));\n        setToken(savedToken);\n      }\n    } catch (err) {\n      console.error(\"Auth load error:\", err);\n      localStorage.clear();\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // ðŸ” LOGIN (ONLY FOR AUTH)\n  const login = (userData, tokenData) => {\n    var _userData$role;\n    if (!userData || !tokenData) return;\n    const normalizedUser = {\n      ...userData,\n      role: ((_userData$role = userData.role) === null || _userData$role === void 0 ? void 0 : _userData$role.toLowerCase()) || \"user\"\n    };\n    setUser(normalizedUser);\n    setToken(tokenData);\n    localStorage.setItem(\"user\", JSON.stringify(normalizedUser));\n    localStorage.setItem(\"token\", tokenData);\n  };\n\n  // ðŸšª LOGOUT\n  const logout = () => {\n    setUser(null);\n    setToken(null);\n    localStorage.clear();\n  };\n\n  // ðŸ›  SAFE PROFILE UPDATE (username, avatar, etc.)\n  const updateUser = updates => {\n    setUser(prev => {\n      if (!prev) return prev;\n      const updatedUser = {\n        ...prev,\n        ...updates\n      };\n      localStorage.setItem(\"user\", JSON.stringify(updatedUser));\n      return updatedUser;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      token,\n      loading,\n      login,\n      logout,\n      setUser: updateUser // âœ… SAFE setter\n    },\n    children: !loading && children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n_s2(AuthProvider, \"uAkFQMmIUxfxJcQTEb8tCM/KFt4=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","user","setUser","token","setToken","loading","setLoading","savedUser","localStorage","getItem","savedToken","JSON","parse","err","console","error","clear","login","userData","tokenData","_userData$role","normalizedUser","role","toLowerCase","setItem","stringify","logout","updateUser","updates","prev","updatedUser","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/anakhiya nikhil/OneDrive/Desktop/mern-ecommerce-full/Gurukrupa-Site/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useEffect\r\n} from \"react\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\nexport const AuthProvider = ({\r\n  children\r\n}) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // ðŸ”¹ Load auth from localStorage\r\n  useEffect(() => {\r\n    try {\r\n      const savedUser = localStorage.getItem(\"user\");\r\n      const savedToken = localStorage.getItem(\"token\");\r\n\r\n      if (savedUser && savedToken) {\r\n        setUser(JSON.parse(savedUser));\r\n        setToken(savedToken);\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Auth load error:\", err);\r\n      localStorage.clear();\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // ðŸ” LOGIN (ONLY FOR AUTH)\r\n  const login = (userData, tokenData) => {\r\n    if (!userData || !tokenData) return;\r\n\r\n    const normalizedUser = {\r\n      ...userData,\r\n      role: userData.role?.toLowerCase() || \"user\",\r\n    };\r\n\r\n    setUser(normalizedUser);\r\n    setToken(tokenData);\r\n\r\n    localStorage.setItem(\"user\", JSON.stringify(normalizedUser));\r\n    localStorage.setItem(\"token\", tokenData);\r\n  };\r\n\r\n  // ðŸšª LOGOUT\r\n  const logout = () => {\r\n    setUser(null);\r\n    setToken(null);\r\n    localStorage.clear();\r\n  };\r\n\r\n  // ðŸ›  SAFE PROFILE UPDATE (username, avatar, etc.)\r\n  const updateUser = (updates) => {\r\n    setUser((prev) => {\r\n      if (!prev) return prev;\r\n      const updatedUser = {\r\n        ...prev,\r\n        ...updates\r\n      };\r\n      localStorage.setItem(\"user\", JSON.stringify(updatedUser));\r\n      return updatedUser;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{\r\n      user,\r\n      token,\r\n      loading,\r\n      login,\r\n      logout,\r\n      setUser: updateUser, // âœ… SAFE setter\r\n    }}>\r\n    {!loading && children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":";;;AAAA,OAAOA,KAAK,IACVC,aAAa,EACbC,UAAU,EACVC,QAAQ,EACRC,SAAS,QACJ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEf,MAAMC,WAAW,gBAAGN,aAAa,CAAC,CAAC;AAEnC,OAAO,MAAMO,OAAO,GAAGA,CAAA;EAAAC,EAAA;EAAA,OAAMP,UAAU,CAACK,WAAW,CAAC;AAAA;AAACE,EAAA,CAAxCD,OAAO;AAEpB,OAAO,MAAME,YAAY,GAAGA,CAAC;EAC3BC;AACF,CAAC,KAAK;EAAAC,GAAA;EACJ,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAACY,KAAK,EAAEC,QAAQ,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACc,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;;EAE5C;EACAC,SAAS,CAAC,MAAM;IACd,IAAI;MACF,MAAMe,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;MAC9C,MAAMC,UAAU,GAAGF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAEhD,IAAIF,SAAS,IAAIG,UAAU,EAAE;QAC3BR,OAAO,CAACS,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC,CAAC;QAC9BH,QAAQ,CAACM,UAAU,CAAC;MACtB;IACF,CAAC,CAAC,OAAOG,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,kBAAkB,EAAEF,GAAG,CAAC;MACtCL,YAAY,CAACQ,KAAK,CAAC,CAAC;IACtB,CAAC,SAAS;MACRV,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMW,KAAK,GAAGA,CAACC,QAAQ,EAAEC,SAAS,KAAK;IAAA,IAAAC,cAAA;IACrC,IAAI,CAACF,QAAQ,IAAI,CAACC,SAAS,EAAE;IAE7B,MAAME,cAAc,GAAG;MACrB,GAAGH,QAAQ;MACXI,IAAI,EAAE,EAAAF,cAAA,GAAAF,QAAQ,CAACI,IAAI,cAAAF,cAAA,uBAAbA,cAAA,CAAeG,WAAW,CAAC,CAAC,KAAI;IACxC,CAAC;IAEDrB,OAAO,CAACmB,cAAc,CAAC;IACvBjB,QAAQ,CAACe,SAAS,CAAC;IAEnBX,YAAY,CAACgB,OAAO,CAAC,MAAM,EAAEb,IAAI,CAACc,SAAS,CAACJ,cAAc,CAAC,CAAC;IAC5Db,YAAY,CAACgB,OAAO,CAAC,OAAO,EAAEL,SAAS,CAAC;EAC1C,CAAC;;EAED;EACA,MAAMO,MAAM,GAAGA,CAAA,KAAM;IACnBxB,OAAO,CAAC,IAAI,CAAC;IACbE,QAAQ,CAAC,IAAI,CAAC;IACdI,YAAY,CAACQ,KAAK,CAAC,CAAC;EACtB,CAAC;;EAED;EACA,MAAMW,UAAU,GAAIC,OAAO,IAAK;IAC9B1B,OAAO,CAAE2B,IAAI,IAAK;MAChB,IAAI,CAACA,IAAI,EAAE,OAAOA,IAAI;MACtB,MAAMC,WAAW,GAAG;QAClB,GAAGD,IAAI;QACP,GAAGD;MACL,CAAC;MACDpB,YAAY,CAACgB,OAAO,CAAC,MAAM,EAAEb,IAAI,CAACc,SAAS,CAACK,WAAW,CAAC,CAAC;MACzD,OAAOA,WAAW;IACpB,CAAC,CAAC;EACJ,CAAC;EAED,oBACEpC,OAAA,CAACC,WAAW,CAACoC,QAAQ;IAACC,KAAK,EAAE;MAC3B/B,IAAI;MACJE,KAAK;MACLE,OAAO;MACPY,KAAK;MACLS,MAAM;MACNxB,OAAO,EAAEyB,UAAU,CAAE;IACvB,CAAE;IAAA5B,QAAA,EACD,CAACM,OAAO,IAAIN;EAAQ;IAAAkC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAE3B,CAAC;AAACpC,GAAA,CAzEWF,YAAY;AAAAuC,EAAA,GAAZvC,YAAY;AAAA,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}